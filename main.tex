\documentclass[a4paper,11pt]{article}
\pdfoutput=1 % if your are submitting a pdflatex (i.e. if you have
             % images in pdf, png or jpg format)

\usepackage{jcappub} % for details on the use of the package, please
                     % see the JCAP-author-manual

\usepackage[T1]{fontenc} % if needed
\newcommand{\ek}[1]{\textcolor{blue}{[{\bf EK}: #1]}}
\allowdisplaybreaks

\title{\boldmath Eigenvalues of the Traceless Tidal Tensor as a Measure of Anisotropy in Ultra-Light Dark Matter}





%% %simple case: 2 authors, same institution
%% \author{A. Uthor}
%% \author{and A. Nother Author}
%% \affiliation{Institution,\\Address, Country}

% more complex case: 4 authors, 3 institutions, 2 footnotes
\author[a]{Emily Kendall}
% \author[c]{S. Econd,}
% \author[a,2]{T. Hird\note{Also at Some University.}}
% \author[a,2]{and Fourth}

% The "\note" macro will give a warning: "Ignoring empty anchor..."
% you can safely ignore it.

\affiliation[a]{The University of Auckland, Private Bag 92019\\
Auckland 1142, New Zealand}
% \affiliation[b]{Another University,\\different-address, Country}
% \affiliation[c]{A School for Advanced Studies,\\some-location, Country}

% e-mail addresses: one for each author, in the same order as the authors
\emailAdd{eken000@aucklanduni.ac.nz}
% \emailAdd{second@asas.edu}
% \emailAdd{third@one.univ}
% \emailAdd{fourth@one.univ}




\abstract{Ultra-Light Dark Matter [ULDM] offers an interesting alternative to the $\Lambda$CDM paradigm, popular in part because of its perceived potential to resolve the contentious `small-scale crisis' of CDM. While the predictions of ULDM and $\Lambda$CDM converge on cosmological scales, it is necessary to understand the precise differences between the predictions of these models on small (kiloparsec) scales. A unique feature of ULDM on these scales is the presence of wave-like interference effects in the underlying dark mater density distribution. Here we investigate statistical tools which could be employed to characterise these effects. Because interference fringes are intrinsically anisotropic structures, we consider not the usual 2-point correlation function of the overdensity distribution, but rather the statistical properties of the eigenvalues of the traceless tidal tensor. We consider the probability distributions of these eigenvalues for the ULDM fields arising during collapse of overdensities, as well their isotropic and anisotropic correlation functions in the principal axis frame. We consider how these statistical measures change with the ULDM particle mass. We find such analyses of the eigenvalues of the traceless tidal tensor to be useful tools to discriminate between the outputs of ULDM simulations initialised with different constituent particle mass parameters (noting that the high-mass limit is representative of standard CDM). We remark upon the potential utility of this statistical method in the context of cosmological ULDM structure formation simulations, for which advanced numerical tools are currently in development.}



\begin{document}
\maketitle
\flushbottom

\section{Introduction}
\label{sec:intro}

As direct-detection experiments continue to constrain the viable parameter space of weakly interacting cold dark matter \cite{Schumann:2019eaa}, interest in alternative dark matter models grows. Ultra-Light Dark Matter [ULDM] presents an alternative to $\Lambda$CDM which, while maintaining agreement on cosmological scales, possesses novel features on small (galactic) scales \cite{Hui:2016ltb}. This small-scale disparity is due to the macroscopic de Broglie wavelength associated with the constituent particle's extremely small mass ($\sim10^{-22}$eV). Because of this large de Broglie wavelength, astrophysical processes such as the collapse of overdensities or the collisions of ULDM halos can be expected to induce complex interference effects. Indeed, imprints of interference patterns are expected to be manifest in the filamentary structure of the cosmic web \cite{Mocz:2019emo}. It is therefore of interest to develop methods with which to quantitatively analyse such structures. Standard N-point statistics are insufficient for this purpose, as the correlations induced by interference fringes within filamentary structures are highly anisotropic. Therefore, we employ a tool previously developed in \cite{Lee:2009uv} which naturally accommodates the anisotropy of the structures of interest. Namely, we numerically compute the traceless tidal tensor of the dark matter density field obtained through ULDM simulations. At each location, this tensor represents the deformation of a given volume element relative to spherical expansion or contraction. We then diagonalise the traceless tidal tensor in order to calculate the probability density distributions and two-point correlation functions of its eigenvalues in the pricipal-axis frame. 

We perform this analysis for density distributions obtained from ULDM simulations using the {\sc PyUltraLight} tool \cite{Edwards:2018ccc}. We simulate the collapse of a single ellipsoidal overdensity in an expanding background. We repeat this for two different ULDM particle mass assumptions, separated by an order of magnitude. We see that for the lighter ULDM particle mass, the Zel'dovich type collapse process is highly disrupted by the effects of wave interference. We then analyse the probability distributions and correlation functions of the eigenvalues of the traceless tidal field at various stages of collapse.

While {\sc PyUltraLight} is a useful simulation tool with which to perform a preliminary investigation of the statistics of the traceless tidal field in the ULDM model, it is limited by fixed spatial resolution. This means that large cosmological volumes cannot be simulated whilst maintaining adequate resolution on the scale of the de Broglie wavelength. However, there are currently a number of efforts to develop advanced ULDM simulation tools, some of which make use of adaptive mesh refinement (AMR) \cite{Mocz:2019emo, Niemeyer:2019aqm, Veltmaat:2019hou}. Such tools will allow cosmological structure formation simulations to be undertaken which incorporate baryonic effects and achieve the necessary resolution to characterise interference effects on the de Broglie scale. We therefore hope that this work serves as a proof-of-principle for in-depth investigations utilising the outputs of more advanced simulation tools. 

The structure of this paper is as follows. In Section \ref{sec:sims}, we discuss the simulations of collapsing overdensities using the {\sc PyUltraLight} tool, and discuss how different ULDM particle masses are implemented. In section \ref{sec:TTT} we review the traceless tidal tensor and its numerical computation on simulation outputs. In Section \ref{sec:collapse}, we discuss the results of the simulations of overdensity collapse, with a focus on the gravitational cooling mechanism for halo relaxation. In Section \ref{sec:probs}, we examine the probability distributions of the eigenvalues of the traceless tidal tensor for the different simulations, demonstrating that the presence of wavefronts and interference patterns in the scalar ULDM field are manifest in these distributions. In Sections \ref{sec:iso} and \ref{sec:aniso} we discuss the isotropic and anisotropic correlation functions of the eigenvalues, respectively. We show that these present useful tools for discriminating between models with differing ULDM particle mass. We conclude in Section \ref{sec:conclusion}.
    


\section{ULDM Simulations of Overdensity Collapse}\label{sec:sims}

In this work we investigate the utility of the statistical properties of the eigenvalues of the traceless tidal tensor as a means by which to quantify differences in the predictions of differing dark matter models. In order to do this, we generate a series of test density fields using the {\sc PyUltraLight} simulation tool \cite{Edwards:2018ccc}. We first modify this tool to incorporate expansion, assuming a matter dominated evolution of the scale factor, namely $a\propto t^{2/3}$. We also incorporate a sponge at the boundary such that ejected matter does not re-enter the simulation region due to the periodic boundary conditions. We use {\sc PyUltraLight} to simulate the collapse of isolated ellipsoidal overdensities in an expanding background, using two different assumptions for the ULDM particle mass. For a sufficiently light ULDM particle mass, the effects of the macroscopic de Broglie wavelength can be expected to impede the Zeldovich type collapse characteristic of CDM \cite{Zeldovich:1969sb}. However, as the ULDM particle mass is increased, we approach a regime in which the correspondence between the Schr{\"o}dinger-Poisson equations of ULDM and the Vlasov-Poisson equations dictates that the dark matter behaves similarly to standard CDM \cite{Mocz:2018ium}. Therefore, as the ULDM particle mass increases, we recover the Zeldovich type scenario in which collapse occurs most rapidly along the shortest axis of the ellipsoidal overdensity. In this work we focus on order of magnitude variations in the ULDM particle mass as this may prove useful for tightening existing mass constraints \cite{Marsh:2018zyw, Armengaud:2017nkf, Irsic:2017yje}. 

We work in the native dimensionless code units of {\sc PyUltraLight} given by 
\begin{align}
    \CMcal{L}&=\left(\frac{8\pi\hbar^2}{3 m^2H_0^2\Omega_{m_0}}\right)^{\frac{1}{4}}\approx121\left(\frac{10^{-23}\operatorname{eV}}{m}\right)^{\frac{1}{2}}\operatorname{kpc},\label{eq:length}\\
    \CMcal{T}&=\left(\frac{8\pi}{3 H_0^2\Omega_{m_0}}\right)^{\frac{1}{2}}\approx75.5 \operatorname{Gyr},\label{eq:time}\\
    \CMcal{M}&=\frac{1}{G}\left(\frac{8\pi}{3 H_0^2\Omega_{m_0}}\right)^{-\frac{1}{4}}\left(\frac{\hbar}{m}\right)^{\frac{3}{2}}\approx 7\times 10^7\left(\frac{10^{-23}\operatorname{eV}}{m}\right)^{\frac{3}{2}}\operatorname{M}_{\odot}.\label{eq:mass}
\end{align}

Working in these units, we can simulate the effects of an increased ULDM particle mass simply by increasing the side length of the simulation region. For example, if we wanted to maintain the same physical initial conditions but with the ULDM mass increased by an order of magnitude, we would need not convert into physical units, but would instead increase the side length of the simulation region by a factor of $\sqrt{10}$ in the dimensionless code units given above. We need not change the density of any input configuration, as it can be seen from the above expressions that the change in the mass unit is exactly cancelled by the change induced by 3 factors of the length unit. Hence, we find it most convenient to work in dimensionless code units, as this obviates the need for an explicit assumption for the ULDM particle mass. Where valuable, we convert quantities of interest into physical units under different ULDM particle mass assumptions to give a sense of scale.

We simulate the collapse of isolated ellipsoidal overdensities, repeating our simulations for two different ULDM mass scales separated by an order of magnitude. The precise details of the simulation setups are discussed in detail in Section \ref{sec:results}. Of course, these initial configurations are highly contrived, and thus cannot be expected to generate physically realistic predictions for large scale cosmological structures. We are presently restricted to these toy models as it is not possible to perform astrophysically realistic structure formation simulations using the {\sc PyUltraLight} tool. This is because simulations of large cosmological volumes necessarily sacrifice spatial resolution, meaning that wave-like effects on the ULDM de Broglie scale are not captured. As it is precisely this wave behaviour which is expected to engender differences in the predictions of ULDM and CDM, such simulations are not useful for our analysis. We note, however, ongoing development of much more sophisticated ULDM simulation tools \cite{Mocz:2019emo, Niemeyer:2019aqm, Veltmaat:2019hou}, from which detailed information about structure formation in the ULDM model can be garnered. This work, therefore, provides a groundwork upon which further investigation can build when better simulation data becomes available.



\section{The Traceless Tidal Field in the Principal Axis Frame}\label{sec:TTT}

From the density fields output by the {\sc PyUltraLight} simulation tool, we construct the traceless tidal tensor at each gridpoint. To do this, we first compute the dimensionless overdensity field:
\begin{equation}
    \delta(\mathrm{\mathbf{x}}) = \frac{\rho(\mathrm{\mathbf{x}})-\Bar{\rho}}{\bar{\rho}}, 
\end{equation}
where $\bar{\rho}$ is the average density throughout the simulation volume. We then take the Fourier transform to obtain the dimensionless density contrast in Fourier space, $\delta(\mathrm{\mathbf{k}})$. From here we can calculate the peculiar gravitational field from the Poisson equation, and finally compute the tidal tensor as the Hessian of the peculiar gravitational potential. In Fourier space we have
\begin{equation}
    \phi(\mathrm{\mathbf{k}}) = k^{-2}\delta(\mathrm{\mathbf{k}}), \qquad T_{ij}(\mathrm{\mathbf{k}}) = k_{i}k_{j}\phi(\mathrm{\mathbf{k}}).
\end{equation}
At each point, the dimensionless density contrast is given by the trace of the tidal tensor. Therefore, in order to isolate the tidal effects, we compute the traceless tidal tensor:
\begin{equation}
    \Tilde{T}_{ij}(\mathrm{\mathbf{k}}) = T_{ij}(\mathrm{\mathbf{k}}) - \frac{\delta(\mathrm{\mathbf{k}})}{3}\mathbb{I}_{ij}.
\end{equation}
Finally we perform an inverse Fourier transform to obtain the traceless tidal tensor in real space. We then randomly select a sample of 15,000 points from the simulation grid at which to diagonalise the tidal tensor, storing the eigenvalues ($\lambda_1$, $\lambda_2$, $\lambda_3$) and unit eigenvectors ($\mathrm{\mathbf{e}}_1$, $\mathrm{\mathbf{e}}_2$, $\mathrm{\mathbf{e}}_3$) for further analysis. We label the eigenvalues such that $\lambda_1 >\lambda_2 > \lambda_3$. Because these are the eigenvalues of the\textit{traceless} tensor, we also have $\lambda_1>0$ and  $\lambda_3 < 0$, while $\lambda_2$ may be either positive or negative.

To compute the correlation functions, we consider the principal axis frame defined by $\mathrm{\mathbf{e}}_1$, $\mathrm{\mathbf{e}}_2$, $\mathrm{\mathbf{e}}_3$ for every sample point $\mathrm{\mathbf{x}}$. We consider pairs of points $\mathrm{\mathbf{x}}$ and $\mathrm{\mathbf{x}}+\mathrm{\mathbf{r}}$, where $\mathrm{\mathbf{r}}$ is the separation vector in the principal axis frame of $\mathrm{\mathbf{x}}$. We convert $\mathrm{\mathbf{r}}$ into spherical polar coordinates $r, \theta, \varphi$ and finally define 
\begin{equation}
    \xi_{\lambda_i}(r, \theta, \varphi) = \langle\lambda_i(\mathrm{\mathbf{x}})\lambda_i(\mathrm{\mathbf{r+x}})\rangle.
\end{equation}
We must of course specify a convention for our definition of $\theta$ and $\varphi$. In this case we choose 
\begin{align}
    r &= \sqrt{e_3^2+e_2^2+e_1^2}\nonumber\\
    \theta &= \tan^{-1}\left(\frac{e_2}{e_3}\right)\nonumber\\
    \varphi &= \cos^{-1}\left(\frac{e_1}{r}\right)\nonumber
\end{align}
We will consider both $\xi_{\lambda_i}(r)$ and $\xi_{\lambda_i}(r,\varphi)$, whereby in the former case the average is taken over all separation vectors in differential bins $[r, r+dr]$, and in the latter case the averages are further separated into differential bins $[\varphi, \varphi + d\varphi]$.

\section{Results}\label{sec:results}

\subsection{Collapse and gravitational cooling of ellipsoidal overdensities}\label{sec:collapse}

We simulated the collapse of randomly oriented ellipsoidal overdensities in an expanding background where the ellipsoid is defined by

\begin{equation}
    \frac{x^2}{a^2}+\frac{y^2}{b^2}+\frac{z^2}{c^2} = R.
\end{equation}

The simulation resolution was $300^3$ and $R$ was chosen to be 100 grid units\footnote{R is defined in terms of grid units since each of our simulations assumes a different ULDM particle mass and therefore a different simulation side length in dimensionless code units. In each case, however, the \textit{physical} length corresponding to each grid space remains the same.}. Meanwhile the parameters ${a, b, c}$ were set to ${1,2,3}$. For the first simulation, the side length was set to 10 {\sc PyUltraLight} code units, and the constant density within the ellipsoid was set to 50 code units. If a ULDM particle mass of $10^{-22}\mathrm{eV}$ is assumed, this corresponds to a simulation side length of $\sim 38 \mathrm{kpc}$, and an ellipsoidal overdensity of mass $1.26\times 10^3 \mathrm{M}_{\odot}$ and volume $31.5 \mathrm{kpc}^3$. Outside of the ellipsoid, the density is rapidly decreased to zero via a Gaussian smoothing.

The ellipsoidal overdensity is initialised at $z=100$, and left to evolve to $z=1.5$. During this time, the overdensity begins to collapse, first inducing interference fringes throughout the simulation region and finally virialising to form a relaxed halo. In the first simulation the side length is set to 10 code units. In the second simulation this is increased to $\sqrt{10}\times 10$ code units, reflecting an order of magnitude increase in ULDM particle mass. Henceforth, we will distinguish between these two scenarios using the designations `$\mathrm{m}_0$' and `$10 \mathrm{m}_0$', avoiding an explicit choice for the ULDM particle mass. 

Figures \ref{fig:contours_light} and \ref{fig:contours_mid} show the (log) density distributions through the central plane of the simulation region for each of the two scenarios (distance not log-scaled). The left panel of Figure \ref{fig:contours_light} shows extended wavefronts emanating from the overdensity near the onset of collapse (z = 99.5) for the $\mathrm{m}_0$ case, while the left panel of \ref{fig:contours_mid} shows significantly reduced wavefronts at the same redshift for $10 \mathrm{m}_0$. In the latter case, the ellipsoid can be seen to be flattening into a `Zeldovich pancake', while in the former case the interference effects are impeding this process. 

The centre panels of Figures \ref{fig:contours_light} and \ref{fig:contours_mid} show how the wavefronts have evolved at z = 96.5. As expected, the interference effects are much more pronounced in the $\mathrm{m}_0$ case. In both the left and centre panels, artifacts of the cubic simulation grid can be observed as faint straight lines and small square regions of overdensity. These sources of error should be kept in mind when analysing statistical correlations within the simulation. 

The rightmost panels of Figures \ref{fig:contours_light} and \ref{fig:contours_mid} show cross-sections through the relaxed halos at z = 1.5. As expected, the size and density contrast of fluctuations is more pronounced in the incoherent outer halo of the $\mathrm{m}_0$ case. 



\begin{figure}[!htb]
\minipage{0.32\textwidth}
  \includegraphics[trim={3cm 0 0 0}, scale=0.5]{single_light_plane_1.png}
\endminipage\hfill
\minipage{0.32\textwidth}
  \includegraphics[trim={3cm 0 0 0},scale=0.5]{single_light_plane_7.png}
\endminipage\hfill
\minipage{0.32\textwidth}
  \includegraphics[trim={3cm 0 0 0},scale=0.5]{single_light_plane_107.png}
\endminipage
\caption{Log density distributions through the centre of the simulation region for the $\mathrm{m}_0$ case. From left to right z = 99.5, z = 96.5, and z = 1.5.}\label{fig:contours_light}
\end{figure}


\begin{figure}[!htb]
\minipage{.32\textwidth}
  \includegraphics[trim={3cm 0 0 0},scale=0.5]{single_mid_plane_1.png}
%   \caption{A really Awesome Image}\label{fig:awesome_image1}
\endminipage\hfill
\minipage{0.32\textwidth}
  \includegraphics[trim={3cm 0 0 0},scale=0.5]{single_mid_plane_7.png}
%   \caption{A really Awesome Image}\label{fig:awesome_image2}
\endminipage\hfill
\minipage{0.32\textwidth}%
  \includegraphics[trim={3cm 0 0 0},scale=0.5]{single_mid_plane_107.png}
%   \caption{A really Awesome Image}\label{fig:awesome_image3}
\endminipage
\caption{Log density distributions through the centre of the simulation region for the $10 \mathrm{m}_0$ case. From left to right z = 99.5, z = 96.5, and z = 1.5.}\label{fig:contours_mid}
\end{figure}


In order for the initial ellipsoidal overdensities to evolve into relaxed halos, mass is expelled from the centre of the simulation through a gravitational cooling mechanism \cite{Seidel:1993zk, Guzman:2006yc}. In this way, excess kinetic energy is removed, allowing the formation of a compact solitonic core. The gravitational cooling mechanism can be viewed as arising from the scattering of the interference fringes generated during the collapse of the overdensity \cite{Arvanitaki:2019rax}. Hence, we expect an exaggerated overall mass loss in cases where the interference fringes are more pronounced, that is, a smaller ULDM particle mass. As time goes on, we expect the mass ejection to become less energetic, enabling a final stable configuration to arise. Indeed, Figure \ref{fig:grav_cool} demonstrates that the gravitational cooling process for the $\mathrm{10m}_0$ case (orange line) terminates at relatively high redshift, with the integrated mass within the simulation region thereafter remaining almost constant. Meanwhile, the $\mathrm{m}_0$ case (blue line) demonstrates a much greater overall mass decrease, extended over a greater time frame. At z = 1.5, the rate of mass loss only just begins to approach zero. Included also in Figure $\ref{fig:grav_cool}$ for reference is the total mass as a function of redshift for $\mathrm{25m}_0$. In this case, only a small proportion of the total mass is lost, occuring at high redshift. Hence, we see that the gravitational cooling mechanism quickly becomes irrelevant at high ULDM particle mass, as the de Broglie wavelength decreases. 

\begin{figure}[!htb]
\minipage{.45\textwidth}
  \includegraphics[trim={1.5cm 0 1cm 0},scale=0.55]{final_profile_comparison.png}
  \caption{Spherical average density profiles at z = 1.5 for varying ULDM particle mass. The solitonic core is clearly visible for mass $\mathrm{m}_0$.}\label{fig:final_prof}
\endminipage\hfill
\minipage{0.45\textwidth}
  \includegraphics[trim={1.6cm 0 0 0.8cm},scale=0.55]{mass_loss_comparison.png}
  \caption{Total mass as a function of redshift for differing ULDM particle mass. Mass is lost due to gravitational cooling.}\label{fig:grav_cool}
\endminipage\hfill
% \caption{A really Awesome Image}\label{fig:awesome_image3}
\end{figure}

Figure \ref{fig:final_prof} demonstrates the spherical averaged density profiles for $\mathrm{m}_0$, $\mathrm{10m}_0$, and $\mathrm{25m}_0$ at z = 1.5. The solitonic core formed in the $\mathrm{m}_0$ case is clearly visible, and is plotted against the numerical solitonic profile (yellow dotted line). We see that the solitonic core transitions into a more NFW-like outer halo at approximately three times the core radius $r_c$, where the core radius is defined as the radius at which the density drops to half of the central value. Such a profile is in accordance with predictions of the generic properties of ULDM halos \cite{Veltmaat:2018dfz, Lin:2018whl, Chavanis:2018pkx}. For the cases in which the particle mass is higher ($\mathrm{10m}_0$, $\mathrm{25m}_0$), the characteristic solitonic core of ULDM is much less well-defined. This change in profile behaviour is consistent with the statement that as ULDM particle mass is increased, we recover the CDM limit in which halos can be described by the semi-analytic NFW profile. 




\subsection{Probability distributions of the eigenvalues of the traceless tidal tensor}\label{sec:probs}

We have thus far seen striking visual differences arise during the collapse of overdensities for differing ULDM particle masses (Figures \ref{fig:contours_light} and \ref{fig:contours_mid}). These differences occur because of interference between the wavefronts of the massive scalar field, ejected during the gravitational cooling process. Wavefronts and their interference patterns are intrinsically anisotropic structures. Thus, it is of interest to analyse such structures using statistical tools designed to take anisotropy into account. As described in Section \ref{sec:TTT}, the traceless tidal tensor at each point in a density field gives the deformation of the corresponding volume element relative to purely spherical expansion or collapse. It is therefore an ideal tool to characterise fields in which structures possessing directional dependence arise. 

In particular, rather than using the traditional isotropic 2-point matter correlation function to analyse density distributions, we can instead examine the 2-point correlation functions of the eigenvalues of the traceless tidal tensor in its principal axis frame, as well as the probability distributions of the eigenvalues. The principal axis frame at each point is defined by the eigenvectors of the traceless tidal field, where the maximal compression of a volume element occurs along the direction of the eigenvector associated with the largest eigenvalue. Hence, this method preserves information about the anisotropy of the local gravitational field. 

Before analysing the correlation functions of the eigenvalues of the traceless tidal tensor, we will examine their overall probability distributions. We will consider the density fields arising during the collapse of ULDM overdensities with differing particle mass, as described in the previous section. In general, we expect the presence of repeated anisotropic structures such as wavefronts to induce peaks in the probability distributions of the eigenvalues, as in such cases there will be a number of volume elements exhibiting the same characteristic anisotropic deformation. In Appendix \ref{app:prob_distro_eg} we demonstrate this effect using artificial density distributions. 

Figure \ref{fig:singles_distros} shows the probability distributions of the eigenvalues of the traceless tidal tensor for z = 96.5 and z = 1.5, where at each redshift we consider density distributions for both $\mathrm{m}_0$ and $\mathrm{10m}_0$. Because the traceless tidal field was computed for 15,000 randomly chosen points within the simulation grid, there are a total of 45,000 data points from which to construct the probability distributions of the three eigenvalues. Because we have a finite number of samples, we must choose a smoothing method to obtain a continuous distribution. In this case, we divide the eigenvalue range $\{-3,+3\}$ into 1000 bins, tallying the number of points which fall into each bin. We represent the outcome of this procedure using the scattered points in Figure \ref{fig:singles_distros}. In order to gauge the presence of peaks in the distribution, we overlay these points with a best-fit cubic spline interpolation. The degree of smoothing will of course affect the visible level of substructure, however we note that the smoothing procedure applied here is sufficient to identify qualitative differences in the probability distributions of the $\mathrm{m}_0$ and $\mathrm{10m}_0$ cases. In particular, we see that at high redshift (z = 96.5), the eigenvalue distribution for the lower ULDM mass case is visibly more uneven than that of the higher ULDM mass case. We see the presence of distinct peaks, indicative of extended anisotropic structures. By contrast, the probability distributions at high redshift are much more similar in appearance, accounting for the fact that distinct elongated wavefronts are no longer present in the relaxed halos. 

\begin{figure}[!htb]

\minipage{0.5\textwidth}
  \includegraphics[trim={1cm 0 0 0},scale=0.8]{distro_single_light_7.png}
%   \caption{A really Awesome Image}\label{fig:awesome_image2}
\endminipage\hfill
\minipage{0.5\textwidth}%
  \includegraphics[trim={1cm 0 0 0},scale=0.8]{distro_single_mid_7.png}
%   \caption{A really Awesome Image}\label{fig:awesome_image3}
\endminipage

\minipage{0.5\textwidth}
  \includegraphics[trim={1cm 0 0 1cm},scale=0.8]{distro_single_light_107.png}
%   \caption{A really Awesome Image}\label{fig:awesome_image2}
\endminipage\hfill
\minipage{0.5\textwidth}%
  \includegraphics[trim={1cm 0 0 1cm},scale=0.8]{distro_single_mid_107.png}
%   \caption{A really Awesome Image}\label{fig:awesome_image3}
\endminipage
\caption{Singles distros}\label{fig:singles_distros}
\end{figure}



\subsection{Isotropic correlation functions of the eigenvalues of the traceless tidal tensor}\label{sec:iso}

Having demonstrated that the probability distributions of the eigenvalues of the traceless tidal tensor can be used as a measure of the degree of anisotropy in a density distribution, we turn now to the correlation functions of the eigenvalues. We will consider first the isotropic correlation functions in the principal axis frame. 

Before we proceed, it is useful to recall what each eigenvalue represents. To this end, we consider briefly the eigenvalues of the \textit{full} tidal tensor, rather than the \textit{traceless} tidal tensor. Each of these eigenvalues represents the magnitude of the second spatial derivative of the peculiar gravitational potential in one of the three principal axis directions\footnote{It is worth noting that the number of positive eigenvalues of the \textit{full} tidal tensor can, in principal, be used as a classification scheme for cosmological structures. In particular: 0 positive eigenvalues corresponds to a "void", 1 positive eigenvalue corresponds to a "sheet", 2 positive eigenvalues corresponds to a "filament" and 3 positive eigenvalues corresponds to a "cluster". This classification, however, has been shown to be ineffective for inhomogeneous distributions, so we do not consider it here \cite{2016MNRAS.457.2501F}.  
}. The principal axis frame is determined independently for each point of the overdensity field so as to diagonalise the tidal tensor at each point. Each of the eigenvalues can be either negative or positive, representing either convexity or concavity \ek{better terminology??}, respectively, of the potential field along the corresponding axis direction. This follows from the usual interpretation of the sign of the second derivative of a curve. We define the eigenvalues such that $\Lambda_1 > \Lambda_2 > \Lambda_3$ (where the capitalisation indicates that these are the eigenvalues of the \textit{full} tidal tensor). Hence, the first principal axis ($\hat{\mathbf{e}}_1$) represents the direction along which concavity is maximal (if $\Lambda_1$ is positive), or convexity is minimal (if $\Lambda_1$ is negative). Conversely, the third principal axis ($\hat{\mathbf{e}}_3$) represents the direction along which convexity is maximal (if $\Lambda_3$ is negative), or concavity is minimal (if $\Lambda_3$ is positive). With this intuition in mind, we return to the eigenvalues of the \textit{traceless} tidal tensor, $\lambda_i = \Lambda_i - \delta/3$. In the traceless case, only $\lambda_2$ may be either positive or negative, while $\lambda_1 > 0$ and $\lambda_3 < 0$. Nevertheless, we still have that $\lambda_1 > \lambda_2 > \lambda_3$, so we can retain the earlier intuition regarding concavity and convexity and use this to predict the behaviour of the correlation functions for different overdensity fields. 

Hence, let us consider an overdensity field in which there are broad troughs in underdense regions but narrow peaks in overdense regions. At a narrow peak (large negative second derivative), we would expect $\vert \lambda_3 \vert$ to be large. Meanwhile, at a broad trough (small positive second derivative), we would expect $\vert \lambda_1 \vert$ to be small. Hence, when looking at the correlation functions of $\lambda_1$ and $\lambda_3$, we would expect the curve for $\lambda_3$ to tend to be higher than that of $\lambda_1$. The opposite would be true for a density distribution with broad peaks and narrow troughs (see Appendix \ref{app:peaks_troughs} for examples). Hence, the relative magnitudes of the correlation functions of these two eigenvalues can inform us about the nature of the underlying density field. Furthermore, we expect density fields which contain clusters to generally exhibit greater $\lambda_1$ and $\lambda_3$ correlations than fields containing extended anisotropic structures such as sheets or filaments (see Appendix \ref{app:peaks_troughs}). We can therefore use this to gauge the relative significance of extended coherent inhomogeneities when comparing different density distributions. 

With these observations in mind, we consider the isotropic correlation functions of the eigenvalues of the traceless tidal tensor for the collapsing overdensities discussed in the previous sections. Again we will compare two cases, m$_0$ and 10m$_0$, at redshifts z = 96.5 (near the onset of collapse) and $z = 1.5$ (relaxed halos). Because of the finite resolution of the simulation grid, the limited number of points to sample at small radii limits the accuracy of the correlation functions at such distances, and thus we plot the correlation functions only for larger radii. Because of this, the impact of small structures present is difficult to determine. Higher resolution simulations in the future should improve these results.  

Figure \ref{fig:iso_corr} displays the isotropic correlation functions of the eigenvalues of the traceless tidal tensor for the collapsing overdensities at redshifts z = 96.5 and z = 1.5. The correlation functions are compared for the ULDM particle mass cases m$_0$ and 10m$_0$. In all cases, it can be seen that $\lambda_1$ and $\lambda_3$ remain coherent over larger scales than $\lambda_2$, for which the correlation function falls off more steeply at large radius. At higher redshift, we see that the correlations are stronger for the higher ULDM particle mass (red lines). This is consistent with the fact that the lower ULDM particle mass case exhibits significant spatially extended interference patterns at this redshift, while these effects are greatly suppressed in the case of the higher particle mass. As discussed above, we expect distributions dominated by cluster-like regions of overdensity to exhibit stronger correlations than distributions dominated by sheet or filament-like structures. Conversely, at low redshift, we see that the $\lambda_1$ and $\lambda_3$ correlations are very similar for both mass regimes. This is indicative of the fact that relaxed halos no longer contain extended sheet-like or filament-like anisotropies, and are instead dominated by incoherent fluctuations. 

Figure \ref{fig:iso_corr} also demonstrates that at both large and small redhsifts, the $\lambda_3$ curve has the highest amplitude at all distances. This is consistent with density distributions containing peaks which are generally broader than troughs, as is expected to arise through gravitational collapse. 

While this analysis is preliminary and does not utilise density distributions from full cosmological structure formation simulations, the differences between the isotropic correlations for the large and small ULDM particle mass cases shown in Figure \ref{fig:iso_corr} indicate that this approach could be utilised to help to constrain the plausible ULDM mass range, or perhaps lend support to either the ULDM or CDM models of dark matter. We note that of course that the anisotropies arise during collapse processes, and are not present in relaxed structures. Therefore this analysis is primarily useful at high redshifts.
 

\begin{figure}[!htb]
\minipage{.5\textwidth}
  \includegraphics[trim={1cm 0 0 0},scale=0.55]{iso_corr_single_7.png}
%   \caption{A really Awesome Image}\label{fig:awesome_image1}
\endminipage\hfill
\minipage{0.5\textwidth}
  \includegraphics[trim={0 0 0 0},scale=0.55]{iso_corr_single_107.png}
%   \caption{A really Awesome Image}\label{fig:awesome_image2}
\endminipage\hfill
\caption{Isotropic correlation functions of the eigenvalues of the traceless tidal tensor. Left: Correlation functions at z = 96.5. Right: Correlation functions at z = 1.5.}\label{fig:iso_corr}
\end{figure}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\subsection{Anisotropic correlation functions of the eigenvalues in the principal axis frame}\label{sec:aniso}

In this section we investigate how the correlation functions described above change with angular separation from the $\hat{\mathbf{e}}_1$ principal axis vector. For simplicity, we show only the correlations of $\lambda_1$, as the behaviour of the other eigenvalues is qualitatively similar. 

Figure \ref{fig:aniso} demonstrates the angular dependence of the correlation functions for the largest eigenvalue. We separate the correlation functions based on bins of angular size 15 degrees in $\varphi$ (the polar angle, i.e. anglular separation from $\hat{\mathbf{e}}_1$). We see clearly that the correlations increase with the $\varphi$ in the principal axis frame at all plotted distances. This angular dependence is to be expected, as we expect maximal compression of matter along the direction of $\hat{\mathbf{e}}_1$, resulting in an excess of matter in the plane normal to this vector. As before, the finite resolution of the simulation grid makes obtaining accurate correlations at small distances difficult, so the plots presented here are truncated. 

From this limited data set, it is difficult to extract detailed predictions of the differences between the large and small ULDM mass cases, though it would appear that at early times, angular separation is more pronounced in the lighter mass case. Future investigation of the anisotropic correlation functions characteristic of different ULDM scenarios will benefit from detailed high resolution simulations.



\begin{figure}[!htb]
\minipage{0.5\textwidth}
  \includegraphics[trim={1cm 0 0 0}, scale=0.57]{aniso_single_light_7_l1.png}
%   \caption{A really Awesome Image}\label{fig:awesome_image1}
\endminipage\hfill
\minipage{0.5\textwidth}
  \includegraphics[trim={1cm 0 0 0},scale=0.57]{aniso_single_mid_7_l1.png}
%   \caption{A really Awesome Image}\label{fig:awesome_image2}
\endminipage\hfill
% \end{figure}

% \begin{figure}
\minipage{0.5\textwidth}%
  \includegraphics[trim={1cm 0 0 1.cm},scale=0.57]{aniso_single_light_107_l1.png}
%   \caption{A really Awesome Image}\label{fig:awesome_image3}
\endminipage
\minipage{.5\textwidth}
  \includegraphics[trim={1cm 0 0 1.cm},scale=0.57]{aniso_single_mid_107_l1.png}
  
\endminipage\hfill
\caption{Anisotropic correlation functions of $\lambda_1$ in the principal axis frame. Top left: z = 96.5, m$_0$. Top right: z = 96.5, 10m$_0$. Bottom left: z = 1.5, m$_0$. Bottom right: z = 1.5, 10m$_0$.}\label{fig:aniso}
\end{figure}



\section{Conclusions}\label{sec:conclusion}

In this paper we have investigated the utility of the traceless tidal tensor as a means by which to characterise the anisotropies in ULDM density distributions arising through wave-like effects on macroscopic scales. We have seen that the probability distributions of the eigenvalues of this tensor exhibit peaks associated with extended filamentary or sheet-like overdensities. The precise position and amplitude of these peaks can be expected to vary with the precise parameters of the underlying ULDM scalar field, and so we suggest that this could serve as a signature through which to determine the suitability of one model over another. Furthermore, we have seen that the correlation functions of the eigenvalues of the traceless tidal tensor can also be used to distinguish between ULDM models with different particle mass parameters. 

Though this work is preliminary in nature, more advanced numerical tools are currently in development which will enable better characterisation of anisotropies within the ULDM model, not just for isolated overdensities, but for large cosmological volumes. The outputs of such detailed simulations can be analysed with the methods employed here in order to obtain a quantitative distinction between anisotropies in different dark matter models. 











\appendix


\section{Distributions of tidal tensor eigenvalues for density field test cases}\label{app:prob_distro_eg}

To illustrate that overdensities containing extended anisotropic structures correspond to eigenvalue distributions possessing characteristic peaks, we consider two artificial distributions. The first distribution is simply a Gaussian random field, while the second is a 2-dimensional plane wavefront, generated by $\rho(x,y,z)=\sin^2{(x)}$. Figure \ref{fig:gaussian_plane_wave} shows the eigenvalue distributions for the two cases. For the Gaussian random field, in which the statistical fluctuations are isotropic, the eigenvalues themselves are characterised by Gaussian distributions. Meanwhile, the 2-dimensional plane wavefront yields eigenvalue distributions with distinct prominent peaks. The exact position and height of the peaks will of course in general depend on the precise parameters of the waveform.


\begin{figure}[!htb]

\minipage{0.5\textwidth}
  \includegraphics[trim={1cm 0 0 0},scale=0.76]{prob_distro_gaussian.png}
%   \caption{A really Awesome Image}\label{fig:awesome_image2}
\endminipage\hfill
\minipage{0.5\textwidth}%
  \includegraphics[trim={0cm 0 1cm 0},scale=0.76]{prob_distro_plane_wave.png}

\endminipage
  \caption{Probability distributions of the eigenvalues of the traceless tidal tensor for sample density distributions. Left: Gaussian random field, Right: $\rho(x,y,z) = \sin^2{(x)}$ }\label{fig:gaussian_plane_wave}
\end{figure}


\section{Changes in isotropic correlation functions for sheets, filaments and clusters}\label{app:peaks_troughs}

The relative amplitudes of the isotropic correlations of the largest and smallest eigenvalues of the traceless tidal tensor are dependent upon the characteristic relative sizes of the peaks and troughs of the overdensity distribution. In Figure \ref{fig:iso_comp} we show the correlation functions obtained for artificial density distributions representing sheet-like structures ($\rho(x,y,z) = \sin^2{(x)}$), filament-like structures ($\rho(x,y,z) = \sin^2{(x)}\sin^2{(y)}$), and clusters ($\rho(x,y,z) = \sin^2{(x)}\sin^2{(y)}\sin^2{(z)}$). The method of construction of these structures, namely multiplication of Sine functions, results in asymmetry between the widths of the overdensity peaks and the widths of the underdensity troughs. Because the peaks are relatively sharper, we see that in all cases the amplitude of the correlation function for $\lambda_3$ is higher than that of $\lambda_1$, with the disparity increasing with additional Sine factors.

It is also the case that density distributions dominated by the presence of cluster-like structures will have higher amplitude correlations in $\lambda_1$ and $\lambda_3$ than will distributions dominated by sheets or filaments. This is due to the presence of compression/expansion along additional directions. Hence, Figure \ref{fig:iso_comp} demonstrates that the sheet-like density distribution exhibits the lowest level of correlation, while the clustered distribution exhibits the highest. This increase in correlation with clustering persists even when the precise form of the density distribution is altered, for example exchanging the clustered distribution with $\rho(x,y,z) = \vert \sin{(x)}\sin{(y)}\sin{(z)}\vert$.


\begin{figure}[!htb]
\centering
\includegraphics[trim={0 0 0 0},scale=0.8]{sheet_filament_cluster.png}
\caption{Isotropic correlation functions for the largest and smallest eigenvalues of the traceless tidal tensor for different forms of structure (sheets: blue lines, filaments: red lines, clusters: green lines).}\label{fig:iso_comp}
\end{figure}





% \acknowledgments

% \paragraph{Note added.} This is also a good position for notes added
% after the paper has been written.





% The bibliography will probably be heavily edited during typesetting.
% We'll parse it and, using the arxiv number or the journal data, will
% query inspire, trying to verify the data (this will probalby spot
% eventual typos) and retrive the document DOI and eventual errata.
% We however suggest to always provide author, title and journal data:
% in short all the informations that clearly identify a document.

\bibliographystyle{JHEP-mod}
\bibliography{refs} 
\end{document}
